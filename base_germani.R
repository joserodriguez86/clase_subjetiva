pacman::p_load(tidyverse)

#Sample A -----------------------
sample_A <- read.csv("bases/base_1961_sampleA.txt", col.names = "codigo")

sample_A <- sample_A %>%
  mutate(id = str_sub(codigo, 1,4),
         v1 = str_sub(codigo, 5,5),
         v2 = str_sub(codigo, 6,6),
         v3 = str_sub(codigo, 7,7),
         v4 = str_sub(codigo, 8,8),
         v5 = str_sub(codigo, 9,9),
         v6 = str_sub(codigo, 10,10),
         v7 = str_sub(codigo, 11,11),
         v8 = str_sub(codigo, 12,12),
         v9 = str_sub(codigo, 13,13),
         v10 = str_sub(codigo, 14,14),
         p1 = str_sub(codigo, 15,16),
         p2 = str_sub(codigo, 17,17),
         p3 = str_sub(codigo, 18,18),
         p4 = str_sub(codigo, 19,19),
         p5 = str_sub(codigo, 20,20),
         p6 = str_sub(codigo, 21,21),
         q1 = str_sub(codigo, 22,23),
         q2 = str_sub(codigo, 24,25),
         q3 = str_sub(codigo, 26,27),
         q4 = str_sub(codigo, 28,29),
         p7 = str_sub(codigo, 30,30),
         q5 = str_sub(codigo, 31,31),
         q6 = str_sub(codigo, 32,32),
         q7 = str_sub(codigo, 33,33),
         q8 = str_sub(codigo, 34,34),
         q9 = str_sub(codigo, 35,36),
         sq1 = str_sub(codigo, 37,38),
         sq2 = str_sub(codigo, 39,39),
         sq3 = str_sub(codigo, 40,42),
         v11 = str_sub(codigo, 43,43),
         v12 = str_sub(codigo, 44,44),
         p8 = str_sub(codigo, 45,46),
         q10 = str_sub(codigo, 47,48),
         q11 = str_sub(codigo, 49,50),
         q12 = str_sub(codigo, 51,52),
         v14 = str_sub(codigo, 53,54),
         p9 = str_sub(codigo, 55,55),
         p10 = str_sub(codigo, 56,56),
         q13 = str_sub(codigo, 57,57),
         q14 = str_sub(codigo, 58,58),
         q15 = str_sub(codigo, 59,59),
         q16 = str_sub(codigo, 60,60),
         q17 = str_sub(codigo, 61,61),
         q18 = str_sub(codigo, 62,62),
         q19 = str_sub(codigo, 63,63),
         q20 = str_sub(codigo, 64,64),
         q21 = str_sub(codigo, 65,65),
         q22 = str_sub(codigo, 66,66),
         q23 = str_sub(codigo, 67,67),
         q24 = str_sub(codigo, 68,68),
         q25 = str_sub(codigo, 69,69),
         q26 = str_sub(codigo, 70,70),
         q27 = str_sub(codigo, 71,71),
         q28 = str_sub(codigo, 72,72),
         q29 = str_sub(codigo, 73,73),
         q30 = str_sub(codigo, 74,74),
         q31 = str_sub(codigo, 75,75),
         q32 = str_sub(codigo, 76,76),
         q33 = str_sub(codigo, 77,77),
         q34 = str_sub(codigo, 78,78),
         q35 = str_sub(codigo, 79,79),
         q36 = str_sub(codigo, 80,80),
         codigo = NULL)


#Sample B-----------------------
sample_B <- read.csv("bases/base_1961_sampleB.txt", col.names = "codigo")

sample_B$card_id <- str_sub(sample_B$codigo, 80,80)

sample_B1 <- subset(sample_B, card_id == 1)
sample_B2 <- subset(sample_B, card_id == 7)
sample_B3 <- subset(sample_B, card_id == 8)
sample_B4 <- subset(sample_B, card_id == 9)

## Card id 1-------------------
sample_B1 <- sample_B1 %>%
  mutate(id = str_sub(codigo, 1,7),
         id2 = str_sub(codigo, 1,4),
         v1 = str_sub(codigo, 8,8),
         v2 = str_sub(codigo, 9,10),
         v3 = str_sub(codigo, 11,11),
         v4 = str_sub(codigo, 12,12),
         v5 = str_sub(codigo, 13,13),
         v6 = str_sub(codigo, 14,14),
         v7 = str_sub(codigo, 15,15),
         v8 = str_sub(codigo, 16,16),
         v9 = str_sub(codigo, 17,17),
         v10 = str_sub(codigo, 18,18),
         v11 = str_sub(codigo, 19,19),
         v12 = str_sub(codigo, 20,21),
         v13 = str_sub(codigo, 22,23),
         v14 = str_sub(codigo, 24,24),
         v15 = str_sub(codigo, 25,25),
         v16 = str_sub(codigo, 26,27),
         v17 = str_sub(codigo, 28,29),
         v18 = str_sub(codigo, 30,30),
         p1 = str_sub(codigo, 31,31),
         p2 = str_sub(codigo, 32,33),
         p3 = str_sub(codigo, 34,34),
         p4 = str_sub(codigo, 35,35),
         p5 = str_sub(codigo, 36,37),
         p6 = str_sub(codigo, 38,38),
         p7 = str_sub(codigo, 39,40),
         p8 = str_sub(codigo, 41,42),
         p9 = str_sub(codigo, 43,44),
         p10 = str_sub(codigo, 45,46),
         p11 = str_sub(codigo, 47,48),
         p12 = str_sub(codigo, 50,50),
         p13 = str_sub(codigo, 51,51),
         p14 = str_sub(codigo, 52,52),
         p15 = str_sub(codigo, 53,53),
         p16 = str_sub(codigo, 54,54),
         p17 = str_sub(codigo, 55,55),
         p18 = str_sub(codigo, 56,57),
         p19 = str_sub(codigo, 58,59),
         q1 = str_sub(codigo, 60,60),
         q2 = str_sub(codigo, 61,61),
         q3 = str_sub(codigo, 62,63),
         q4 = str_sub(codigo, 64,64),
         q5 = str_sub(codigo, 65,67),
         v19 = str_sub(codigo, 68,68),
         q6 = str_sub(codigo, 69,69),
         sq1_q6 = str_sub(codigo, 70,71),
         sq2_q6 = str_sub(codigo, 72,72),
         sq3_q6 = str_sub(codigo, 73,75),
         v21 = str_sub(codigo, 76,76),
         v22 = str_sub(codigo, 77,77),
         codigo = NULL)


## Card id 2-------------------
sample_B2 <- sample_B2 %>%
  mutate(id = str_sub(codigo, 1,4),
         id2 = id,
         q7 = str_sub(codigo, 5,6),
         q8 = str_sub(codigo, 7,7),
         q9 = str_sub(codigo, 8,9),
         sq1_q9 = str_sub(codigo, 10,11),
         sq2_q9 = str_sub(codigo, 12,12),
         sq3_q9 = str_sub(codigo, 13,15),
         v23 = str_sub(codigo, 16,16),
         v24 = str_sub(codigo, 17,17),
         q10 = str_sub(codigo, 18,19),
         sq1_q10 = str_sub(codigo, 20,21),
         sq2_q10 = str_sub(codigo, 22,22),
         sq3_q10 = str_sub(codigo, 23,25),
         v25 = str_sub(codigo, 26,26),
         v26 = str_sub(codigo, 27,27),
         q11 = str_sub(codigo, 28,29),
         sq1_q11 = str_sub(codigo, 30,31),
         sq2_q11 = str_sub(codigo, 32,32),
         sq3_q11 = str_sub(codigo, 33,35),
         v27 = str_sub(codigo, 36,36),
         v28 = str_sub(codigo, 37,37),
         q12 = str_sub(codigo, 38,39),
         sq1_q12 = str_sub(codigo, 40,41),
         sq2_q12 = str_sub(codigo, 42,42),
         sq3_q12 = str_sub(codigo, 43,45),
         v29 = str_sub(codigo, 46,46),
         v30 = str_sub(codigo, 47,47),
         q13 = str_sub(codigo, 48,48),
         sq1_q13 = str_sub(codigo, 49,50),
         q14 = str_sub(codigo, 51,52),
         q15 = str_sub(codigo, 53,53),
         p20 = str_sub(codigo, 54,54),
         p21 = str_sub(codigo, 55,56),
         q16 = str_sub(codigo, 57,57),
         sq1_q16 = str_sub(codigo, 58,60),
         v31 = str_sub(codigo, 61,61),
         v32 = str_sub(codigo, 62,62),
         q17 = str_sub(codigo, 63,63),
         q18 = str_sub(codigo, 64,65),
         sq1_q18 = str_sub(codigo, 66,66),
         sq2_q18 = str_sub(codigo, 67,69),
         v33 = str_sub(codigo, 70,70),
         v34 = str_sub(codigo, 71,71),
         v35 = str_sub(codigo, 72,73),
         v36 = str_sub(codigo, 74,75),
         codigo = NULL)


## Card id 3-------------------
sample_B3 <- sample_B3 %>%
  mutate(id = str_sub(codigo, 1,4),
         id2 = id,
         v37 = str_sub(codigo, 5,6),
         v38 = str_sub(codigo, 7,8),
         v39 = str_sub(codigo, 9,10),
         q19_1 = str_sub(codigo, 11,12),
         q19_2 = str_sub(codigo, 13,14),
         q19_3 = str_sub(codigo, 15,16),
         q20 = str_sub(codigo, 17,17),
         q21 = str_sub(codigo, 18,19),
         q22 = str_sub(codigo, 20,20),
         q23 = str_sub(codigo, 21,22),
         q24 = str_sub(codigo, 23,23),
         q25 = str_sub(codigo, 24,24),
         q26 = str_sub(codigo, 25,25),
         q27 = str_sub(codigo, 26,26),
         q28 = str_sub(codigo, 27,27),
         q29 = str_sub(codigo, 28,28),
         v40 = str_sub(codigo, 29,30),
         p22 = str_sub(codigo, 31,31),
         q30 = str_sub(codigo, 32,33),
         q31 = str_sub(codigo, 34,35),
         v41 = str_sub(codigo, 36,37),
         v42 = str_sub(codigo, 38,38),
         q32_1 = str_sub(codigo, 39,39),
         q32_2 = str_sub(codigo, 40,40),
         q32_3 = str_sub(codigo, 41,41),
         q32_5 = str_sub(codigo, 42,42),
         q32_6 = str_sub(codigo, 43,43),
         q32_7 = str_sub(codigo, 44,44),
         q32_8 = str_sub(codigo, 45,45),
         q33_1 = str_sub(codigo, 46,46),
         q33_2 = str_sub(codigo, 47,47),
         q33_3 = str_sub(codigo, 48,48),
         q33_4 = str_sub(codigo, 49,49),
         q33_5 = str_sub(codigo, 50,50),
         q33_6 = str_sub(codigo, 51,51),
         q33_7 = str_sub(codigo, 52,52),
         q33_8 = str_sub(codigo, 53,53),
         q33_9 = str_sub(codigo, 54,54),
         q33_10 = str_sub(codigo, 55,55),
         q33_11 = str_sub(codigo, 56,56),
         q34 = str_sub(codigo, 57,58),
         q35 = str_sub(codigo, 59,60),
         q36 = str_sub(codigo, 61,61),
         v43 = str_sub(codigo, 62,62),
         q37_1 = str_sub(codigo, 63,63),
         q37_2 = str_sub(codigo, 64,64),
         q37_3 = str_sub(codigo, 65,65),
         q37_4 = str_sub(codigo, 66,66),
         q37_5 = str_sub(codigo, 67,67),
         q37_6 = str_sub(codigo, 68,68),
         q37_7 = str_sub(codigo, 69,69),
         v44 = str_sub(codigo, 70,70),
         q38 = str_sub(codigo, 71,72),
         q39 = str_sub(codigo, 73,74),
         q40_1 = str_sub(codigo, 75,75),
         q40_2 = str_sub(codigo, 76,76),
         q40_3 = str_sub(codigo, 77,77),
         codigo = NULL)


## Card id 4-------------------
sample_B4 <- sample_B4 %>%
  mutate(id = str_sub(codigo, 1,4),
         id2 = id,
         q40_4 = str_sub(codigo, 5,5),
         q40_5 = str_sub(codigo, 6,6),
         q40_6 = str_sub(codigo, 7,7),
         q40_7 = str_sub(codigo, 8,8),
         q40_8 = str_sub(codigo, 9,9),
         q40_9 = str_sub(codigo, 10,10),
         q40_10 = str_sub(codigo, 11,11),
         q40_11 = str_sub(codigo, 12,12),
         q40_12 = str_sub(codigo, 13,13),
         v45 = str_sub(codigo, 14,15),
         q41_1 = str_sub(codigo, 16,16),
         q41_2 = str_sub(codigo, 17,17),
         q41_3 = str_sub(codigo, 18,18),
         q41_4 = str_sub(codigo, 19,19),
         q41_5 = str_sub(codigo, 20,20),
         q41_6 = str_sub(codigo, 21,21),
         q41_7 = str_sub(codigo, 22,22),
         q41_8 = str_sub(codigo, 23,23),
         q41_9 = str_sub(codigo, 24,24),
         q41_10 = str_sub(codigo, 25,25),
         v46 = str_sub(codigo, 26,27),
         q42 = str_sub(codigo, 28,29),
         q43 = str_sub(codigo, 30,30),
         p23 = str_sub(codigo, 31,31),
         p24 = str_sub(codigo, 32,32),
         p25 = str_sub(codigo, 33,33),
         p26 = str_sub(codigo, 34,34),
         q44 = str_sub(codigo, 35,35),
         q45 = str_sub(codigo, 36,36),
         q46 = str_sub(codigo, 37,37),
         q47 = str_sub(codigo, 38,38),
         q48 = str_sub(codigo, 39,39),
         q49 = str_sub(codigo, 40,40),
         q50 = str_sub(codigo, 41,41),
         q51 = str_sub(codigo, 42,42),
         q52 = str_sub(codigo, 43,43),
         q53 = str_sub(codigo, 44,44),
         q54 = str_sub(codigo, 45,45),
         q55 = str_sub(codigo, 46,46),
         q56 = str_sub(codigo, 47,47),
         q57 = str_sub(codigo, 48,48),
         q58 = str_sub(codigo, 49,49),
         q59 = str_sub(codigo, 50,50),
         q60 = str_sub(codigo, 51,51),
         q61 = str_sub(codigo, 52,52),
         q62 = str_sub(codigo, 53,53),
         q63 = str_sub(codigo, 54,54),
         q64 = str_sub(codigo, 55,55),
         q65 = str_sub(codigo, 56,56),
         q66 = str_sub(codigo, 57,57),
         q67 = str_sub(codigo, 58,59),
         q68 = str_sub(codigo, 60,61),
         q69 = str_sub(codigo, 62,63),
         q69 = str_sub(codigo, 64,65),
         q70 = str_sub(codigo, 66,67),
         q71 = str_sub(codigo, 68,68),
         q72 = str_sub(codigo, 69,69),
         p27 = str_sub(codigo, 70,70),
         p28 = str_sub(codigo, 71,71),
         codigo = NULL)


## Pegado Sample B -------------------
sample_B <- sample_B1 %>%
  right_join(sample_B2, by = "id2") %>%
  left_join(sample_B3, by = "id2") %>%
  left_join(sample_B4, by = "id2")

save(sample_B, file = "bases/germani_sampleb.RData")

rm(sample_B1, sample_B2, sample_B3, sample_B4)
